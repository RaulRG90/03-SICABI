var api_leer_acreditadores=base_url+"/administrador/acreditacion/leer_usuarios/2",api_leer_editoriales=base_url+"/administrador/acreditacion/leer_usuarios/3",api_crear_usuario=base_url+"/administrador/acreditacion/agregar_usuario",api_eliminar_usuario=base_url+"/administrador/acreditacion/eliminar_usuario",api_actualizar_usuario=base_url+"/administrador/acreditacion/actualizar_usuario",componente_cabecera=base_url+"/assets/js/herramientas/jumbotron.min.js",componente_btn_agregar_usuario=base_url+
"/assets/js/administrador/acreditacion/gestion_usuarios/btn_agregar_usuario.min.js",componente_tabs_usuarios=base_url+"/assets/js/herramientas/tabs.min.js",componente_tablas_usuarios=base_url+"/assets/js/herramientas/tabla.min.js",componente_frm_agregar_usuario=base_url+"/assets/js/administrador/acreditacion/gestion_usuarios/frm_agregar_usuario.min.js",componente_frm_editar_usuario=base_url+"/assets/js/administrador/acreditacion/gestion_usuarios/frm_editar_usuario.min.js",encabezado,btn_agregar_usuario,
tabs_usuarios,tabla_editorial,tabla_acreditador;
$(document).ready(function(){function d(a,b){return $(a).DataTable({ajax:{url:b,method:"GET",cache:"false",dataSrc:""},columns:[{data:"usu_nombre",title:"NOMBRE"},{data:"usu_login",title:"USUARIO"},{data:"id_perfil",title:"PERFIL",render:function(a){return 2===parseInt(a)?"Acreditador":"Editorial"}},{data:"usu_pass",title:"CONTRASE\u00d1A",render:function(a){return'<input class="border-0" type="password" value="'+a+'" />'}},{data:"usu_id",title:"OPCIONES",render:function(a){return'<div class="btn-group btn-group-sm" role="group" aria-label="Basic example"><button id="btn_editar_usuario" id_usuario="'+
a+'" type="button" class="btn btn-info"><i class="fa fa-edit"></i></button><button id="btn_eliminar_usuario" id_usuario="'+a+'" type="button" class="btn btn-danger"><i class="fa fa-eraser"></i></button></div>'}}],responsive:!0,paging:!1,info:!1})}$.getScript(componente_cabecera,function(){let a=$("#cabecera_principal");$(a).append(jumbotron.render("GESTI\u00d3N DE USUARIOS"));encabezado=a});$.getScript(componente_btn_agregar_usuario,function(){let a=$("#div_agregar_usuario");$(a).append(btn_agregar_usuario.render());
btn_agregar_usuario=a});$.getScript(componente_tabs_usuarios,function(){let a=$("#section_tabs");$(a).append(tabs.render(["Acreditador","Editorial"]));tabs_usuarios=a});$.getScript(componente_tablas_usuarios,function(){$("#sand_box");$("#pane_acreditador").append(tablas.render("acreditador"));tabla_acreditador=d($("#tbl_acreditador"),api_leer_acreditadores);$("#pane_editorial").addClass("active show");$("#pane_editorial").append(tablas.render("editorial"));tabla_editorial=d($("#tbl_editorial"),api_leer_editoriales);
$("#pane_editorial").removeClass("active show")});$.getScript(componente_frm_agregar_usuario,function(){$("#sand_box").append(frm_agregar_usuario.render())});$(document).off("click","#btn_agregar_usuario");$(document).on("click","#btn_agregar_usuario",function(){$("#frm_agregar_usuario").trigger("reset");$("#mdl_agregar_usuario").modal("show")});$(document).off("submit","#frm_agregar_usuario");$(document).on("submit","#frm_agregar_usuario",function(){event.preventDefault();event.stopPropagation();
if(!1===this.checkValidity())this.classList.add("was-validated");else{let a={},b=$("#txt_nombre").val(),c=$("#txt_usuario").val(),e=$("#txt_contrasenia").val();a.usu_nombre=b;a.usu_login=c;a.id_perfil=2;a.usu_pass=e;$.ajax({url:api_crear_usuario,type:"POST",dataType:"JSON",data:a,contentType:"application/x-www-form-urlencoded; charset=UTF-8",success:function(a){console.log(a);a.error?swal("Error!",a.error.message,"error"):(swal("Exito!",a.message,"success"),tabla_editorial.ajax.reload(null,!1),tabla_acreditador.ajax.reload(null,
!1))},error:function(a,b){swal("Error!","Error desconocido, comuniquese con el administrador","error")}})}});$(document).off("click","#btn_eliminar_usuario");$(document).on("click","#btn_eliminar_usuario",function(){let a=$(this).attr("id_usuario");swal({title:"\u00bfEstas seguro?",text:"\u00a1No podras deshacer esto!",type:"warning",showCancelButton:!0,confirmButtonClass:"btn-danger",confirmButtonText:"\u00a1Si, Hazlo!",closeOnConfirm:!1},function(){$.ajax({url:api_eliminar_usuario,type:"POST",dataType:"json",
contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:{usu_id:a},success:function(a){a.error?swal("Error!",a.error.message,"error"):(swal("Exito!",a.message,"success"),tabla_editorial.ajax.reload(null,!1),tabla_acreditador.ajax.reload(null,!1))},error:function(a){swal("Error!","Error desconocido, comuniquese con el administrador","error")}})})});$.getScript(componente_frm_editar_usuario,function(){$("#sand_box").append(frm_editar_usuario.render())});$(document).off("click","#btn_editar_usuario");
$(document).on("click","#btn_editar_usuario",function(){$("#frm_editar_usuario").trigger("reset");let a=$(this).closest("tr");a.find("td:eq(0)").html();let b="Acreditador"===a.find("td:eq(2)").text()?2:3,c=$(a.find("td:eq(3)").html());$("#btn_actualizar_usuario").attr("id_usuario",$(this).attr("id_usuario"));$("#frm_editar_usuario").trigger("reset");$("#edit_txt_nombre").val(a.find("td:eq(0)").text());$("#edit_txt_usuario").val(a.find("td:eq(1)").text());$("#btn_actualizar_usuario").attr("id_perfil",
b);$("#edit_txt_contrasenia").val($(c).val());$("#edit_txt_confirmar").val($(c).val());$("#mdl_editar_usuario").modal("show")});$(document).off("submit","#frm_editar_usuario");$(document).on("submit","#frm_editar_usuario",function(){event.preventDefault();event.stopPropagation();if(!1===this.checkValidity())this.classList.add("was-validated");else{let a={},b=$("#btn_actualizar_usuario").attr("id_usuario"),c=$("#btn_actualizar_usuario").attr("id_perfil"),e=$("#edit_txt_nombre").val(),d=$("#edit_txt_usuario").val(),
f=$("#edit_txt_contrasenia").val();a.usu_id=b;a.id_perfil=c;a.usu_nombre=e;a.usu_login=d;a.usu_pass=f;$.ajax({url:api_actualizar_usuario,type:"POST",dataType:"JSON",data:a,contentType:"application/x-www-form-urlencoded; charset=UTF-8",success:function(a){console.log(a);a.error?swal("Error!",a.error.message,"error"):(swal("Exito!",a.message,"success"),tabla_editorial.ajax.reload(null,!1),tabla_acreditador.ajax.reload(null,!1))},error:function(a,b){swal("Error!","Error desconocido, comuniquese con el administrador",
"error")}})}});$(document).off("change","#txt_contrasenia");$(document).on("change","#txt_contrasenia",function(){let a=$(this).val();$("#txt_confirmar").attr("pattern",a)});$(document).off("change","#edit_txt_contrasenia");$(document).on("change","#edit_txt_contrasenia",function(){let a=$(this).val();$("#edit_txt_confirmar").attr("pattern",a)})});