var componentes=base_url+"assets/js/administrador/convocatoria/atributos_generales/componentes.min.js",api_leer_atributos_generales=base_url+"administrador/convocatoria/leer_atributos_generales",api_guardar_atributos_generales=base_url+"administrador/convocatoria/guardar_atributos_generales",api_subir_logo=base_url+"administrador/convocatoria/subir_logo",componente_cabecera,componente_opciones,componente_frm_atributos_generales,componente_frm_agregar_logo,datos={};
$(document).ready(function(){sessionStorage.clear();(function(a,b){$.ajax({url:a,type:"GET",dataType:"JSON",async:!1,contentType:"application/x-www-form-urlencoded; charset=UTF-8",success:function(a){datos[b]=a}})})(api_leer_atributos_generales,"atributos_generales");$("#cabecera_principal").children().remove();$("#opciones").children().remove();$("#formulario_atributos_generales").children().remove();(function(){$.ajax({async:!1,url:componentes,dataType:"SCRIPT",success:function(){componente_cabecera=
cabecera;componente_opciones=opciones;componente_frm_atributos_generales=frm_atributos_generales;componente_frm_agregar_logo=frm_agregar_logo}})})();(function(){let a=$("#cabecera_principal");$(a).append(componente_cabecera.render())})();(function(){let a=$("#opciones");$(a).append(componente_opciones.render())})();(function(){let a=$("#formulario_atributos_generales");$(a).append(componente_frm_atributos_generales.render())})();$("#modales").append(componente_frm_agregar_logo.render());$("#anio").val(datos.atributos_generales[0].anio);
$("#ciclo").val(datos.atributos_generales[0].ciclo);$("#sistema").val(datos.atributos_generales[0].nombre_sistema);$("#proceso").val(datos.atributos_generales[0].nombre_proceso);$("#siglas").val(datos.atributos_generales[0].siglas);switch(datos.atributos_generales[0].biblioteca){case "Escolares":$("#biblioteca option[value=1]").attr("selected","selected");break;case "Aula":$("#biblioteca option[value=2]").attr("selected","selected");break;case "Escolares y de Aula":$("#biblioteca option[value=3]").attr("selected",
"selected")}$(document).off("submit","#frm_atributos_generales");$(document).on("submit","#frm_atributos_generales",function(){event.preventDefault();event.stopPropagation();let a={anio:$("#anio").val(),ciclo:$("#ciclo").val(),nombre_sistema:$("#sistema").val(),nombre_proceso:$("#proceso").val(),siglas:$("#siglas").val()};switch($("#biblioteca").val()){case "1":a.biblioteca="Escolares";break;case "2":a.biblioteca="Aula";break;case "3":a.biblioteca="Escolares y de Aula"}!1===this.checkValidity()?this.classList.add("was-validated"):
$.ajax({url:api_guardar_atributos_generales,type:"POST",dataType:"JSON",contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:a,success:function(a){a.error?swal("Error!",a.error.message,"error"):swal("Exito!",a.message,"success")},error:function(a){swal("Error!","Error Interno, comuniquese con el administrador","error")}})});$(document).on("change",".img_form",function(){let a=this.files[0];if("image/jpeg"!=a.type&&"image/png"!=a.type)$(this).val(""),swal("Error!","La imagen debe ser solo en formato .jpeg (.jpg) o .png",
"error");else if(12E7<a.size)$(this).val(""),swal("Error!","La imagen no debe pesar m\u00e1s de 15 Megabytes!","error");else{let b=new FileReader;b.readAsDataURL(a);$(b).on("load",function(a){a=a.target.result;$(".img_previa").attr("src",a)})}});$(document).off("click","#btn_subir_logo");$(document).on("click","#btn_subir_logo",function(){$("#create_img_previa").attr("src","");$("#frm_agregar_logo").trigger("reset");$("#mdl_agregar_logo").modal("show")});$(document).off("submit","#frm_agregar_logo");
$(document).on("submit","#frm_agregar_logo",function(){event.preventDefault();event.stopPropagation();if(!1===this.checkValidity())this.classList.add("was-validated");else{let a=new FormData,b=document.getElementById("subir_logo").files[0];a.append("logo",b);$.ajax({url:api_subir_logo,type:"POST",data:a,contentType:!1,processData:!1,cache:!1,success:function(a){swal("Hecho!","El logotipo ha sido creado con exito!","success")},error:function(a){swal("Error!","El logotipo no pudo ser creado!","error")}})}})});