var api_leer_datos_activacion=base_url+"editorial/registro/leer_datos_activacion",api_activar_editorial=base_url+"editorial/registro/activar_editorial",api_leer_datos_registro_titulo=base_url+"editorial/registro/leer_datos_registro_titulo",paises,estados,municipios;
$(document).ready(function(){let f=$("#editorial_estatus").val(),g=$("#editorial_folio").val();if("1"===f)$.ajax({url:api_leer_datos_registro_titulo,type:"POST",dataType:"JSON",contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:"folio="+g,success:function(a){console.log(a);sessionStorage.setItem("autores",JSON.stringify([]));$.getScript(base_url+"assets/js/editorial/registro_titulos/form_registro.js",function(){form_registro.data=a;form_registro.render()});$.getScript(base_url+"assets/js/editorial/registro_titulos/form_crear_autor.js",
function(){form_autor.data=a;form_autor.render()});$(document).off("submit","#form_autores");$(document).on("submit","#form_autores",function(a){a.preventDefault();a.stopPropagation();a=$("#form_autores_tipo_autor").val();let b=$("#form_autores_nombre").val();$("#form_autores_pais_origen").val();JSON.parse(sessionStorage.getItem("autores"));let d=$("<option>"),e=$("<li>",{"class":"list-group-item"});$(d).text("["+a+"] "+b);$(e).text("["+a+"] "+b);$("#form_registro_autores").append(d);$("#list_autores_form_registro").append(e);
$("#modal_form_autores").modal("hide");$(this).trigger("reset")})},error:function(a){console.log(a)}});else{var k=function(){let a={},b=$("#form_activacion_editorial_rfc").val(),c=$("#form_activacion_editorial_grupo_editorial").val(),d=$("#form_activacion_editorial_colonia").val(),e=$("#form_activacion_editorial_calle").val(),h=$("#form_activacion_editorial_numero_exterior").val(),l=$("#form_activacion_editorial_cp").val(),f=$("#form_activacion_editorial_ciudad").val(),k=$("#form_activacion_editorial_pais").val(),
m=$("#form_activacion_editorial_entidad_federativa").val(),n=$("#form_activacion_editorial_del_mun").val(),p=$("#form_activacion_editorial_telefono").val(),q=$("#form_activacion_editorial_email").val();a.folio=g;a.edi_rfc=b;a.edi_grupoedit=c;a.edi_colonia=d;a.edi_calle=e;a.edi_numero=h;a.edi_cp=l;a.edi_ciudad=f;a.edi_pais=k;a.edi_entidad_federativa=m;a.edi_delegacion=n;a.edi_telefonos=p;a.edi_email=q;return a};$.ajax({url:api_leer_datos_activacion,type:"POST",dataType:"JSON",contentType:"application/x-www-form-urlencoded; charset=UTF-8",
data:"folio="+g,success:function(a){let b=JSON.stringify(a);sessionStorage.clear();sessionStorage.setItem("datos_activacion",b);"success"===a.editorial.status&&"success"===a.sellos_editoriales.status&&"success"===a.paises.status&&"success"===a.estados.status&&"success"===a.municipios.status&&(paises=a.paises,estados=a.estados,municipios=a.municipios,$.getScript(base_url+"assets/js/editorial/registro_titulos/form_activacion_editorial.js",function(){form_activacion_editorial.data=a;form_activacion_editorial.alertar("Antes de iniciar con el registro de titulos debe validar los siguientes datos");
form_activacion_editorial.render()}))},error:function(a){console.log(a,"error");document.write(a.responseText)}});$(document).off("submit","#form_activacion_editorial");$(document).on("submit","#form_activacion_editorial",function(a){a.preventDefault();a.stopPropagation();a=k();$.ajax({url:api_activar_editorial,type:"POST",dataType:"JSON",contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:a,success:function(a){"Editorial Activada"===a.message?swal("Exito!",a.message,"success"):swal("Error!",
a.error.message,"error")},error:function(a){console.log(a)}})})}$(document).on("focusout","#form_activacion_editorial_pais",a=>{a=JSON.parse(sessionStorage.getItem("mostrar_entidades"));if("M\u00e9xico"===$("#form_activacion_editorial_pais").val()){if(null===a||!1===a){a=$("#form_activacion_editorial_entidad_federativa");var b=$(a).parent();let c=$("<select>",{"class":"custom-select",id:"form_activacion_editorial_entidad_federativa"});JSON.parse(sessionStorage.getItem("datos_activacion")).estados.data.forEach(a=>
{let b=$("<option>",{value:a.est_estado});$(b).text(a.est_estado);$(c).append(b)});$(b).append($(c));$(a).remove();sessionStorage.setItem("mostrar_entidades","true")}}else if(null!==a||!0===a){a=$("#form_activacion_editorial_entidad_federativa");b=$("#form_activacion_editorial_del_mun");let c=$(a).parent(),d=$(b).parent(),e=$("<input>",{type:"text","class":"form-control",id:"form_activacion_editorial_entidad_federativa"}),h=$("<input>",{type:"text","class":"form-control",id:"form_activacion_editorial_del_mun"});
$(c).append($(e));$(d).append($(h));$(a).remove();$(b).remove();sessionStorage.setItem("mostrar_entidades","false")}});$(document).on("focusout","#form_activacion_editorial_entidad_federativa",a=>{a=$("#form_activacion_editorial_del_mun");let b=$(a).parent(),c=$("<select>",{"class":"custom-select",id:"form_activacion_editorial_del_mun"}),d=JSON.parse(sessionStorage.getItem("datos_activacion")),e=d.estados.data.filter(a=>a.est_estado===$("#form_activacion_editorial_entidad_federativa").val());$(c).children().remove();
d.municipios.data.forEach(a=>{if(e[0].est_id===a.est_id){let b=$("<option>",{value:a.mun_municipio});$(b).text(a.mun_municipio);$(c).append(b)}});$(b).append($(c));$(a).remove()})});