$(document).ready(function(){function d(){$(".btn_agregar_sello").off("click"); $(".btn_agregar_sello").click(function(){let a = $(this).parent().parent(); g(this); c++; $(a).after($("<div>", {id:"sello_editorial_" + c, "class":"input-group mb-3 sello_editorial"}).append($("<div>", {"class":"input-group-prepend"}).append($("<span>", {"class":"input-group-text"}).text("Sello Editorial:"))).append($("<input>", {id:"txt_sello_editorial_" + c, type:"text", "class":"form-control sello_editorial", placeholder:"Nuevo sello editorial"})).append($("<div>",
        {"class":"input-group-append"}).append($("<button>", {type:"button", "class":"btn btn-danger btnEliminarSello", btnAgregarSello:"true"}).append($("<i>", {"class":"far fa-minus-square"}))).append($("<button>", {type:"button", "class":"btn btn-primary btn_agregar_sello"}).append($("<i>", {"class":"far fa-plus-square"}))))); $(this).remove(); d(); h()})}function g(a){$("#" + $(a).parent().parent().attr("id") + " div.input-group-append button.btnEliminarSello").attr("btnagregarsello") && $("#" + $(a).parent().parent().attr("id") +
        " div.input-group-append button.btnEliminarSello").attr("btnagregarsello", "false")}function h(){$(".btnEliminarSello").off("click"); $(".btnEliminarSello").click(function(){if ("true" === $(this).attr("btnagregarsello")){var a = $(this).parent().parent().attr("id"); $("#" + $("#" + a).prev().attr("id") + " div.input-group-append").append($(".btn_agregar_sello")); $("#" + $("#" + a).prev().attr("id") + " div.input-group-append button.btnEliminarSello").attr("btnagregarsello", "true"); d()}$("#" + $(this).parent().parent().attr("id")).remove()})}
function l(){let a = 0, b = "{"; $(".sello_editorial").each(function(){"" != $(this).val() && (b += '"' + a + '":"' + $(this).val() + '",', a++)}); b = b.slice(0, b.length - 1); return b += "}"}function m(a){$("#tbl_editoriales_acreditadas").remove(); $("#div_editoriales_acreditadas").append($("<table>", {id:"tbl_editoriales_acreditadas", "class":"table table-hover"})); $("#tbl_editoriales_acreditadas").append($("<thead>")); $("#tbl_editoriales_acreditadas thead").append($("<tr>")); $("#tbl_editoriales_acreditadas thead tr").append($("<td>").text("Folio"));
        $("#tbl_editoriales_acreditadas thead tr").append($("<td>").text("Raz\u00f3n Social")); $("#tbl_editoriales_acreditadas thead tr").append($("<td>").text("Editorial")); $("#tbl_editoriales_acreditadas thead tr").append($("<td>").text("Acuse")); $("#tbl_editoriales_acreditadas thead tr").append($("<td>").text("Opciones")); $("#tbl_editoriales_acreditadas").append($("<tbody>")); a.forEach(function(a){$("#tbl_editoriales_acreditadas tbody").append($("<tr>", {id:a.id}).append($("<td>").text(a.id)).append($("<td>").text(a.edi_razonsocial)).append($("<td>").text(a.edi_grupoedit)).append($("<td>").append('<i class="fa fa-file"></i>')).append($("<td>").append($("<div>",
        {"class":"btn-group btn-group-sm"}).append($("<button>", {"class":"btn btn-primary btn_edit"}).append($("<i>", {"class":"fa fa-edit"}))).append($("<button>", {"class":"btn btn-danger btn_eliminar_editorial"}).append($("<i>", {"class":"fa fa-eraser"}))))))}); $("#mdlAcreditarEditorial").css("display", "none"); n(); p()}function n(){$(".btn_edit").on("click", function(){let a = $(this).parent().parent().parent().attr("id"), b = JSON.parse(sessionStorage.getItem('"' + a + '"')); $("#mdl_editar_editorial").modal("show");
        $("#mdl_editar_editorial #edit_txt_razon_social").focus(); $("#mdl_editar_editorial #edit_txt_razon_social").attr("id_editorial", b.id); $("#mdl_editar_editorial #edit_txt_razon_social").val(b.edi_razonsocial); $("#mdl_editar_editorial #edit_txt_grupo_editorial").val(b.edi_grupoedit); $("#mdl_editar_editorial #edit_txt_nombre_director_general").val(b.edi_dirgeneral); $("#mdl_editar_editorial #edit_txt_email_director_general").val(b.edi_dirmail); $("#mdl_editar_editorial #edit_txt_celular_director_general").val(b.edi_dircel);
        $("#mdl_editar_editorial #edit_txt_nombre_representante_editorial").val(b.edi_repnombre); $("#mdl_editar_editorial #edit_txt_cargo_representante_editorial").val(b.edi_repcargo); $("#mdl_editar_editorial #edit_txt_email_representante_editorial").val(b.edi_repemail); $("#mdl_editar_editorial #edit_txt_observaciones").val(b.edi_observaciones); e(); let k = 0; b.sellos.forEach(function(a){k++; $("#mdl_editar_editorial #edit_txt_sello_editorial_" + c).val(a.sel_sello); k < b.sellos.length && $("#edit_sello_editorial_" +
        c + " button.btn_agregar_sello_editar").trigger("click")})})}function e(){$(".sello_editorial").each(function(a){a = $(this).attr("id"); $("#" + a + " button.btnEliminarSello").trigger("click"); c = 1})}function f(){$(".btn_agregar_sello_editar").off("click"); $(".btn_agregar_sello_editar").click(function(){let a = $(this).parent().parent(); g(this); c++; $(a).after($("<div>", {id:"edit_sello_editorial_" + c, "class":"input-group mb-3 sello_editorial"}).append($("<div>", {"class":"input-group-prepend"}).append($("<span>",
        {"class":"input-group-text"}).text("Sello Editorial:"))).append($("<input>", {id:"edit_txt_sello_editorial_" + c, type:"text", "class":"form-control edit_sello_editorial", placeholder:"Nuevo sello editorial"})).append($("<div>", {"class":"input-group-append"}).append($("<button>", {type:"button", "class":"btn btn-danger btnEliminarSello", btnAgregarSello:"true"}).append($("<i>", {"class":"far fa-minus-square"}))).append($("<button>", {type:"button", "class":"btn btn-primary btn_agregar_sello_editar"}).append($("<i>",
        {"class":"far fa-plus-square"}))))); $(this).remove(); f(); q()})}function q(){$(".btnEliminarSello").off("click"); $(".btnEliminarSello").click(function(){if ("true" === $(this).attr("btnagregarsello")){var a = $(this).parent().parent().attr("id"); $("#" + $("#" + a).prev().attr("id") + " div.input-group-append").append($(".btn_agregar_sello_editar")); $("#" + $("#" + a).prev().attr("id") + " div.input-group-append button.btnEliminarSello").attr("btnagregarsello", "true"); f()}$("#" + $(this).parent().parent().attr("id")).remove()})}
function p(){$(".btn_eliminar_editorial").off("click"); $(".btn_eliminar_editorial").on("click", function(){let a = $(this).parent().parent().parent().attr("id"); $(this).parent().parent().parent().remove(); $.ajax({url:apiEliminarEditorial, type:"GET", data:"idEditorial=" + a, dataType:"json", success:function(){swal("Editorial Eliminada!", "La editorial se elimin\u00f3 con exito!", "success")}, error:function(a){swal("Error!", "La editorial no se pudo eliminar con exito!", "error"); console.log(a)}})})}function r(){let a =
        0, b = "{"; $(".edit_sello_editorial").each(function(){"" != $(this).val() && (b += '"' + a + '":"' + $(this).val() + '",', a++)}); b = b.slice(0, b.length - 1); return b += ',"' + ++a + '":"' + $("#edit_txt_sello_editorial_1").val() + '"}'}var c = 1; $("#btnCancelar").on("click", function(){$("#frmAcreditarEditorial").trigger("reset"); e()}); $("#cardAcreditarEditorial").on("click", function(){$("#tbl_editoriales_acreditadas").remove(); $("#frm_editar_editorial").trigger("reset"); $("#frmAcreditarEditorial").trigger("reset"); e(); $("#mdlAcreditarEditorial").css("display",
        "block")}); $("#btnCancelar").on("click", function(){$("#frmAcreditarEditorial").trigger("reset"); $("#mdlAcreditarEditorial").modal("hide")}); $("#frmAcreditarEditorial").on("submit", function(a){a.preventDefault(); a = {razonSocial:$("#txt_razon_social").val(), grupoEditorial:$("#txt_grupo_editorial").val(), sellos:l(), nombreDirectorGeneral:$("#txt_nombre_director_general").val(), emailDirectorGeneral:$("#txt_email_director_general").val(), celularDirectorGeneral:$("#txt_celular_director_general").val(), nombreRepresentanteEditorial:$("#txt_nombre_representante_editorial").val(),
        cargoRepresentanteEditorial:$("#txt_cargo_representante_editorial").val(), emailRepresentanteEditorial:$("#txt_email_representante_editorial").val(), observaciones:$("#txt_observaciones").val()}; $.ajax({async:!0, type:"POST", dataType:"json", contentType:"application/x-www-form-urlencoded; charset=UTF-8", url:apiAcreditarEditorial, data:a, success:function(a){swal("Registro Exitoso!", "La editorial se acredito con exito", "success")}, error:function(a){swal("Error en el registro!", "La editorial no se pudo acreditar con exito",
        "error")}})}); $("#btn_buscar_editorial").on("click", function(){let a = $("#txt_buscar_editorial").val(), b = ""; 1 <= a.length?(b = $.isNumeric(a)?{id:a}:{edi_razonsocial:a}, $.ajax({async:!0, type:"POST", dataType:"json", contentType:"application/x-www-form-urlencoded; charset=UTF-8", url:apiBuscarEditorial, data:b, success:function(a){sessionStorage.clear(); a.forEach(function(a){sessionStorage.setItem(JSON.stringify(a.id), JSON.stringify(a))}); m(a)}, error:function(a){swal("Ateci\u00f3n!", "No se encontraron coincidencias",
        "warning")}})):(console.log("error"), $("#txt_buscar_editorial").tooltip())}); $("#frm_editar_editorial").on("submit", function(a){a.preventDefault(); a = {id:$("#edit_txt_razon_social").attr("id_editorial"), razonSocial:$("#edit_txt_razon_social").val(), grupoEditorial:$("#edit_txt_grupo_editorial").val(), sellos:r(), nombreDirectorGeneral:$("#edit_txt_nombre_director_general").val(), emailDirectorGeneral:$("#edit_txt_email_director_general").val(), celularDirectorGeneral:$("#edit_txt_celular_director_general").val(),
        nombreRepresentanteEditorial:$("#edit_txt_nombre_representante_editorial").val(), cargoRepresentanteEditorial:$("#edit_txt_cargo_representante_editorial").val(), emailRepresentanteEditorial:$("#edit_txt_email_representante_editorial").val(), observaciones:$("#edit_txt_observaciones").val()}; $.ajax({url:apiActualizarEditorial, async:!0, type:"POST", dataType:"json", contentType:"application/x-www-form-urlencoded; charset=UTF-8", data:a, success:function(a){$("#mdl_editar_editorial").modal("hide"); swal("Actualizaci\u00f3n Exitosa!",
        "La editorial se actualiz\u00f3 con exito", "success"); $("#btn_buscar_editorial").trigger("click")}, error:function(a){swal("Error en la actualizaci\u00f3n!", "La editorial no se pudo actualizar con exito", "error"); document.write(a.responseText)}})}); d(); f(); h()});